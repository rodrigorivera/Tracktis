<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>HTTP Builder - SSL</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
      </head>
  <body class="composite">
    <div id="banner">
                  <a href="index.html" id="bannerLeft">
    
                                            <img src="../images/logo.png" alt="" />
    
            </a>
                        <a href="../../" id="bannerRight">
    
                                    <img src="http://media.xircles.codehaus.org/_projects/groovy/_logos/medium.png" alt="" />
    
            </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
            
  
    
            <div class="xleft">
        Version: 0.5.0-SNAPSHOT
              </div>
            <div class="xright">      
  

  
    
            
  
    
             Last Published: 2009-06-15
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
            
  
    
                   <h5>Overview</h5>
            <ul>
              
    <li class="none">
                    <a href="../home.html">Home</a>
          </li>
              
    <li class="none">
                    <a href="../index.html">News</a>
          </li>
              
    <li class="none">
                    <a href="../download.html">Download</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
            
              
            <li class="expanded">
                    <a href="../doc/index.html">Documentation</a>
                  <ul>
                  
    <li class="none">
                    <a href="../doc/get.html">GET Examples</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/post.html">POST Examples</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/json.html">JSON</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/xml.html">XML</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/rest.html">RESTClient</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/async.html">AsyncHTTPBuilder</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/contentTypes.html">Content Types</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/uribuilder.html">URIBuilder</a>
          </li>
                  
    <li class="none">
              <strong>SSL</strong>
        </li>
              </ul>
        </li>
              
    <li class="none">
                    <a href="../apidocs/index.html">JavaDoc</a>
          </li>
              
    <li class="none">
                    <a href="../changes.html">Changelog</a>
          </li>
              
    <li class="none">
                    <a href="http://twitter.com/httpbuilder" class="externalLink">Twitter!</a>
          </li>
              
    <li class="none">
                    <a href="../home.html#Support">Support</a>
          </li>
              
    <li class="none">
                    <a href="../about.html">About</a>
          </li>
          </ul>
              <h5>Additional Reference</h5>
            <ul>
              
    <li class="none">
                    <a href="../../../Documentation">Groovy</a>
          </li>
              
    <li class="none">
                    <a href="http://hc.apache.org/httpcomponents-client/" class="externalLink">HttpClient</a>
          </li>
              
    <li class="none">
                    <a href="http://hc.apache.org/httpcomponents-core/" class="externalLink">HttpCore</a>
          </li>
              
    <li class="none">
                    <a href="http://json-lib.sourceforge.net/" class="externalLink">JSON-Lib</a>
          </li>
              
    <li class="none">
                    <a href="http://nekohtml.sourceforge.net/" class="externalLink">NekoHTML</a>
          </li>
          </ul>
              <h5>Project Documentation</h5>
            <ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../project-info.html">Project Information</a>
                </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../project-reports.html">Project Reports</a>
                </li>
          </ul>
                                           <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img alt="Built by Maven" src="../images/logos/maven-feather.png"></img>
          </a>
                       
  

  
    
            
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>SSL Configuration</h2>
<p>SSL should, for the most part, &quot;just work.&quot; There are a few situations where it is not completely intuitive.</p>
<div class="section"><h3>SSLPeerUnverifiedException</h3>
<p>If you can't connect to an SSL website, it is likely because the certificate chain is not trusted. This is an Apache HttpClient issue, but explained here for convenience. To correct the untrusted certificate, you need to import a certificate into an SSL truststore.</p>
<p>First, export a certificate from the website using your browser. For example, if you go to <i>https://dev.java.net</i> in Firefox, you will probably get a warning in your browser. Choose &quot;Add Exception,&quot; &quot;Get Certificate,&quot; &quot;View,&quot; &quot;Details tab.&quot; Choose a certificate in the chain and export it as a PEM file. You can view the details of the exported certificate like so:</p>
<div class="source"><pre>$ keytool -printcert -file EquifaxSecureGlobaleBusinessCA-1.crt 
Owner: CN=Equifax Secure Global eBusiness CA-1, O=Equifax Secure Inc., C=US
Issuer: CN=Equifax Secure Global eBusiness CA-1, O=Equifax Secure Inc., C=US
Serial number: 1
Valid from: Mon Jun 21 00:00:00 EDT 1999 until: Sun Jun 21 00:00:00 EDT 2020
Certificate fingerprints:
         MD5:  8F:5D:77:06:27:C4:98:3C:5B:93:78:E7:D7:7D:9B:CC
         SHA1: 7E:78:4A:10:1C:82:65:CC:2D:E1:F1:6D:47:B4:40:CA:D9:0A:19:45
         Signature algorithm name: MD5withRSA
         Version: 3
....</pre>
</div>
<p>Now, import that into a Java keystore file:</p>
<div class="source"><pre>$ keytool -importcert -alias &quot;equifax-ca&quot; -file EquifaxSecureGlobaleBusinessCA-1.crt \
&gt; -keystore truststore.jks -storepass test1234
Owner: CN=Equifax Secure Global eBusiness CA-1, O=Equifax Secure Inc., C=US
Issuer: CN=Equifax Secure Global eBusiness CA-1, O=Equifax Secure Inc., C=US
Serial number: 1
Valid from: Mon Jun 21 00:00:00 EDT 1999 until: Sun Jun 21 00:00:00 EDT 2020
Certificate fingerprints:
         MD5:  8F:5D:77:06:27:C4:98:3C:5B:93:78:E7:D7:7D:9B:CC
         SHA1: 7E:78:4A:10:1C:82:65:CC:2D:E1:F1:6D:47:B4:40:CA:D9:0A:19:45
         Signature algorithm name: MD5withRSA
         Version: 3
...
Trust this certificate? [no]:  yes
Certificate was added to keystore</pre>
</div>
<p>Now you want to use this truststore in your client:</p>
<div class="source"><pre>        import groovyx.net.http.HTTPBuilder
        import static groovyx.net.http.Method.HEAD
        
        import java.security.KeyStore
        import org.apache.http.conn.scheme.Scheme
        import org.apache.http.conn.ssl.SSLSocketFactory

        def http = new HTTPBuilder( 'https://www.dev.java.net/' )

        def keyStore = KeyStore.getInstance( KeyStore.defaultType )
        
        getClass().getResource( &quot;/truststore.jks&quot; ).withInputStream {
           keyStore.load( it, &quot;test1234&quot;.toCharArray() )
        }

        http.client.connectionManager.schemeRegistry.register( 
                        new Scheme(&quot;https&quot;, new SSLSocketFactory(keyStore), 443) )
                        
        def status = http.request( HEAD ) {
                response.success = { it.status }
        }</pre>
</div>
</div>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2008-2009
    
          
  

  
    
            
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
