<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>HTTP Builder - REST</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
      </head>
  <body class="composite">
    <div id="banner">
                  <a href="index.html" id="bannerLeft">
    
                                            <img src="../images/logo.png" alt="" />
    
            </a>
                        <a href="../../" id="bannerRight">
    
                                    <img src="http://media.xircles.codehaus.org/_projects/groovy/_logos/medium.png" alt="" />
    
            </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
            
  
    
            <div class="xleft">
        Version: 0.5.0-SNAPSHOT
              </div>
            <div class="xright">      
  

  
    
            
  
    
             Last Published: 2009-06-15
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
            
  
    
                   <h5>Overview</h5>
            <ul>
              
    <li class="none">
                    <a href="../home.html">Home</a>
          </li>
              
    <li class="none">
                    <a href="../index.html">News</a>
          </li>
              
    <li class="none">
                    <a href="../download.html">Download</a>
          </li>
              
                
              
      
            
      
            
      
            
      
            
            
            
      
            
      
            
      
            
      
              
            <li class="expanded">
                    <a href="../doc/index.html">Documentation</a>
                  <ul>
                  
    <li class="none">
                    <a href="../doc/get.html">GET Examples</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/post.html">POST Examples</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/json.html">JSON</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/xml.html">XML</a>
          </li>
                  
    <li class="none">
              <strong>RESTClient</strong>
        </li>
                  
    <li class="none">
                    <a href="../doc/async.html">AsyncHTTPBuilder</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/contentTypes.html">Content Types</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/uribuilder.html">URIBuilder</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/ssl.html">SSL</a>
          </li>
              </ul>
        </li>
              
    <li class="none">
                    <a href="../apidocs/index.html">JavaDoc</a>
          </li>
              
    <li class="none">
                    <a href="../changes.html">Changelog</a>
          </li>
              
    <li class="none">
                    <a href="http://twitter.com/httpbuilder" class="externalLink">Twitter!</a>
          </li>
              
    <li class="none">
                    <a href="../home.html#Support">Support</a>
          </li>
              
    <li class="none">
                    <a href="../about.html">About</a>
          </li>
          </ul>
              <h5>Additional Reference</h5>
            <ul>
              
    <li class="none">
                    <a href="../../../Documentation">Groovy</a>
          </li>
              
    <li class="none">
                    <a href="http://hc.apache.org/httpcomponents-client/" class="externalLink">HttpClient</a>
          </li>
              
    <li class="none">
                    <a href="http://hc.apache.org/httpcomponents-core/" class="externalLink">HttpCore</a>
          </li>
              
    <li class="none">
                    <a href="http://json-lib.sourceforge.net/" class="externalLink">JSON-Lib</a>
          </li>
              
    <li class="none">
                    <a href="http://nekohtml.sourceforge.net/" class="externalLink">NekoHTML</a>
          </li>
          </ul>
              <h5>Project Documentation</h5>
            <ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../project-info.html">Project Information</a>
                </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../project-reports.html">Project Reports</a>
                </li>
          </ul>
                                           <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img alt="Built by Maven" src="../images/logos/maven-feather.png"></img>
          </a>
                       
  

  
    
            
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>RESTClient</h2>
<p>RESTClient is an extension of HTTPBuilder, which makes a few concessions in HTTPBuilder's flexibility in order to make REST operations as simple as possible. </p>
<p>RESTClient makes great use of the automatic content-type parsing and encoding which makes working with XML and JSON extremely easy, both in the request and response side. It also adds some additional convenience methods for response header parsing. </p>
<p>The main advantages of RESTClient are:</p>
<ol type="1"><li>RESTClient has convenience methods for <tt>get</tt>, <tt>put</tt> <tt>post</tt> <tt>delete</tt>, <tt>head</tt></li>
<li>The response data is always parsed and buffered in-memory</li>
<li>The returned <tt><a href="../apidocs/groovyx/net/http/HttpResponseDecorator.html">HttpResponseDecorator</a></tt> instance gives convenient access to headers and the parsed response data</li>
<li>No user-defined closure is needed</li>
</ol>
<div class="section"><h3>Examples</h3>
<p>All of these examples use the <a href="http://apiwiki.twitter.com/REST+API+Documentation" class="externalLink">Twitter REST API.</a> </p>
<div class="section"><h4>Test a URL using the <tt>HEAD</tt> method </h4>
<div class="source"><pre>import groovyx.net.http.RESTClient
import groovy.util.slurpersupport.GPathResult
import static groovyx.net.http.ContentType.URLENC

twitter = new RESTClient( 'https://twitter.com/statuses/' )
twitter.auth.basic userName, passwd


try { // expect an exception from a 404 response:
    twitter.head path : 'public_timeline'
    assert false, 'Expected exception'
}
// The exception is used for flow control but has access to the response as well:
catch( ex ) { assert ex.response.status == 404 }

assert twitter.head( path : 'public_timeline.json' ).status == 200</pre>
</div>
<p>The above example takes advantage of HTTPBuilder's default failure handler, which will cause an exception to be thrown for any 'failed' response. That exception will still allow access to details of the response (e.g. the response status or message). </p>
</div>
<div class="section"><h4><tt>GET</tt> our friends' timeline</h4>
<div class="source"><pre>def resp = twitter.get( path : 'friends_timeline.json' )
assert resp.status == 200
assert resp.contentType == JSON.toString()
assert ( resp.data instanceof net.sf.json.JSON )
assert resp.data.status.size() &gt; 0</pre>
</div>
<p>All request parameters are defined <a href="../apidocs/groovyx/net/http/HTTPBuilder.RequestConfigDelegate.html#setPropertiesFromMap(java.util.Map)">here</a>.</p>
<p>The <tt>resp</tt> field in the above example is an instance of <tt>HttpResponseDecorator</tt>. Calling <tt>resp.getData()</tt> returns the parsed response content. This is the same parsed response that you would get passed to HTTPBuilder's response handler closure, but it is always buffered in-memory and the response stream is automatically closed. </p>
</div>
<div class="section"><h4><tt>POST</tt> a status update to Twitter!</h4>
<div class="source"><pre>def msg = &quot;I'm using HTTPBuilder's RESTClient on ${new Date()}&quot;

resp = twitter.post( path : 'update.xml',
                     body : [ status:msg, source:'httpbuilder' ],
                     requestContentType : URLENC )

assert resp.status == 200
assert ( resp.data instanceof GPathResult ) // parsed using XmlSlurper
assert resp.data.text == msg
assert resp.data.user.screen_name == userName
def postID = resp.data.id.toInteger()</pre>
</div>
<p>Note that the above example is posting the request data as <tt>application/x-www-form-urlencoded</tt>. (The twitter API doesn't support XML or JSON POST requests.) For this reason, a <tt>requestContentType</tt> parameter must be specified in order to identify how the request body should be serialized. </p>
<p>Also note that we're requesting <tt>update.xml</tt>, not <tt>update.json</tt>. Since we never set a default content-type on the RESTClient instance or pass a <tt>contentType</tt> argument in this request, RESTClient will put <tt>Accept: */*</tt> in the request header, and parse the response based on whatever is given in the response content-type header. So because Twitter correctly identifies its response as <tt>application/xml</tt>, it will automatically be parsed by the default <a href="../apidocs/groovyx/net/http/ParserRegistry.html#parseXML(org.apache.http.HttpResponse)">XML parser</a>.</p>
</div>
<div class="section"><h4>Now <tt>DELETE</tt> that post</h4>
<div class="source"><pre>resp = twitter.delete( path : &quot;destroy/${postID}.json&quot; )
assert resp.status == 200
assert resp.data.id == postID
println &quot;Test tweet ID ${resp.data.id} was deleted.&quot;</pre>
</div>
</div>
</div>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2008-2009
    
          
  

  
    
            
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
